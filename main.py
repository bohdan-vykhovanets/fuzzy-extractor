import numpy as np

from fuzzy_extractor import FuzzyExtractor

fe = FuzzyExtractor(100, 20000, 1)

# test data, range (-10**6, 10**6), shape[0] = 512
X = np.array([-591198, 67518, -292234, -61471, -704923, -369248, -706263, -342095, -30491, -742585, 302408, 328739, -768248, -980251, 854112, 644399, -759762, -712999, -177469, -119691, 486116, -991437, -577904, -199155, 57317, 465593, 876301, -847294, 171185, -458366, -432042, -377389, -721715, 157388, -378566, -76997, 19942, 566479, 139566, 838612, -529683, -667436, -71855, -173289, -246090, -42501, -955549, 728331, -139793, 373989, -712990, -675529, -593852, 185410, -223997, -954603, 640259, 895426, 358891, -813003, -432165, 798101, -544061, 644991, -336892, -55195, 128094, 398110, -98805, -890500, 744657, -863328, -694456, 409931, 542791, -755337, 443532, -922004, 488098, 744002, 289308, -24764, -64925, -826375, -134429, -301819, 919882, 391776, -228622, 819725, -975656, 17180, 669663, 851080, 235715, 69626, 61998, -8371, -795394, -77403, 324899, -372396, -70594, 714766, -323760, -933698, -840666, 903878, 284098, -117736, 132727, -428525, -866301, -414231, 555221, 80952, -10399, -96107, -800340, 143393, -52483, -839359, -560093, 779904, 86484, -485245, -906979, -778704, 466953, 26229, 63633, 64712, -788917, -551375, -125501, -426662, -117377, 846203, -858613, 589117, 742356, -287800, -65408, -38404, 963806, -26801, -590972, -241372, -161292, -586500, 942176, -215299, -239536, 647467, 175505, 675496, -811419, -901831, -643137, -92023, 775780, -49315, -549091, 730288, 983286, 524667, 365438, -756046, -830724, -568682, 752507, -358398, 747168, 184224, 649422, 693877, 408549, -976313, -115674, -622161, -454649, -907046, -508471, -459064, 173512, 318715, -498334, 196223, -458334, -84122, -871128, -893788, -105752, 395884, -870438, -935941, -928454, -846020, 998399, -905310, 739693, 248116, 883525, 778225, 731764, 378044, -178371, 277275, 238865, 264065, 41385, -100042, 663253, 207659, 260015, 966557, -837217, -933066, 86712, 601462, 436018, 543760, -825333, 96926, 583392, 607135, 543406, -349231, -988614, 401744, 52042, 678469, 537750, 505042, 539325, 783400, 723024, 328223, 562364, -884743, -957590, 390341, 824331, -175744, 314351, 906201, -261529, 760137, -441794, 949473, 837351, 841426, 369144, 583180, -613527, -273258, -19477, -496785, -642697, 661105, -818935, 589028, -512829, -508270, -167856, 208003, 464506, 887607, -593672, -519505, -772372, -209769, 805035, -655336, 723971, -887264, -113432, 331090, -156825, 578343, -155390, 641714, 402344, -90626, 852013, -239719, -315850, 211034, -221047, -662252, 673942, 565401, -216902, -589553, 241329, -352301, 345565, 213156, 722798, 584411, 277611, -236536, -971055, -60276, -897093, -821094, 266558, 633202, 46451, 898068, -65433, -112682, -572636, -614968, -882467, 794440, 317681, -876133, -214410, -332444, 308323, 2067, 148798, -370779, -889689, -214377, -422352, -174496, -657434, -254195, -243291, 958148, 773782, 692149, -641984, -860760, -867776, -678417, 921796, 41229, 363706, -9171, 180834, 476729, 718147, 557215, -61518, -854521, -833789, -958987, 546299, -688111, 295537, -754987, -13357, -676526, 762769, -391440, -681950, 246705, 353845, -931484, 885699, -620695, 668063, -806287, 446779, -752769, 524801, -798395, 53695, -631253, -851091, 47347, -796328, 433778, 909713, -971901, 367694, 703540, -665858, -664770, -634021, -815999, 439686, -450409, 707834, 85937, 759118, 100281, -517685, -382714, 289697, -282164, -865724, 61369, -585493, 838791, -608278, 512985, -215682, -118551, 934236, -814800, -795378, 836605, -317215, 666660, -906333, 274909, 520250, -753573, -1218, -880913, 508019, -310108, 685640, 162682, 400181, 82518, 574317, -587745, -648007, -328449, -254827, -555013, 980341, 672693, -84938, -177439, 984880, -169538, -123974, -908408, 668640, -208665, 808280, -567656, 174366, 74024, 688689, 518509, 262168, -555821, -605775, 181333, -196216, -183363, -430109, 672311, 945245, -210630, 522211, 836005, -314311, -807718, -743212, -792373, 170064, 320926, 817538, 606657, 621045, -525791, 862103, 681877, 714923, -893104, 454776, 192551, -308385, 924311, 328599, -223223, 396409, 188803, -356069, -346719, 668045, -950763, -717675, 825892, 184087, -37348, -825156, 81468, 22352, 810475, -981442, 831511, 769534, 603646, 105050, 483007, -564125, -519124, -420018, 369875, -758208, -226178, 471027, 725757, -693427, -140320, 902646, -258759, -77622, 314924, 271797, 430933, 203227, 724754, 160345, -705352, 6687, -785163, 179421, 158062, 475642, 852583, 870508, 986306, -464541, -561370, 309752, 350168, -808941, 624717, 772197, -970681, 206864, -522013, -866087, 422870, -70089, -403861, -891940, -897785, -695900, 677339, 283143, -75218, 859668, -63257, -873995, -267413, 665944, -779836, 87665, 236470, 837832, -627818, 402161, 306511, -693302, 105730, 662482, 349009, -602238, -661795, -438193, 516217, 814708, -895000, -671603, 148070, -58666, 979783, -405105, 825211, -321303, -511906, -186330, -176004, 392991, -849813, 724804, 798068, -815871, 565809, 613005, 832361, 363830, -400539, -164332, 132939, 644989, 558783, -152618, -99231, 442271, 628639, 532949, -961128, 711055, -788688, 948113, 47093, -829497, -467660, 542642, 113915, 501103, -815826, -166690, -243844, -6626, 469208, 380648, 947708, -8636, 684203, -85813, 784169, -386457, 102456, 653354, -527471, -630475, -667127, -256320, 244317, 326010, 472436, 957700, 466484, -821834, 682741, -151828, 486003, 139380, -877259, -383802, -512397, 449639, -671873, -823002, -322843, 879821, -382419, 829543, -408761, -567433, 929581, 157135, 320888, -773751, 359618, -241162, 391300, -45644, 172610, -139298, -751169, 242947, 537424, -89297, -180609, -911745, 6330, -805050, -498080, 223757, -514079, -862834, -928123, 925139, 711536, 901933, 455496, -754174, 326149, -559675, 363590, -860204, 718957, 804830, -905607, -658115, 957264, 466740, -108886, -32201, 159427, -346829, -651932, -754620, -12206, -763201, 336937, -742688, -322893, -135082, 409789, 957897, -718752, 233996, 373053, 90936, 365846, -500575, -588703, -398012, 38817, -236226, -778017, -837425, -393903, 215927, -155211, -547, -834545, 47072, -959119, 874742, -560379, 738009, -43652, 207929, -272733, 777337, 955750, -708673, 705656, 254418, -274824, 37885, -510174, 112104, -779596, -245672, 9556, -788259, 446721, 517485, -46990, -559432, -907442, -792606, -535618, -527464, -315207, 739955, 48352, -587742, 683548, 229855, -446630, 819458, -284170, -311957, -791042, -79803, -328392, -10404, 105217, -998548, 206812, 328761, -321505, -623357, 993815, -40002, -9123, 213889, 344474, 222751, -686745, -514204, 648324, -208974, -538641, -37911, 679209, -325592, -733711, -830174, 757524, -517408, -939700, -42553, -230881, 268106, 7759, -174588, -200926, -603406, -988386, -265213, -325710, 199159, 492476, 451055, -690693, -919321, 601246, 71016, 244949, 791637, 75981, -429209, 426395, 35536, -853923, -625063, 491997, -45166, 11411, -590375, -534677, 920760, -564264, 945685, 914975, 241678, 877123, 796216, -110890, 626970, 286562, -429931, 677679, 365040, 206381, -198601, -537533, -533628, 61243, -593283, 942644, 76604, -122925, -170951, 575522, 620425, -752170, -272205, -40584, -381736, 713173, -63873, 661227, -840963, -610691, 237633, 165539, -91123, -835005, -834161, 998858, -993688, -779714, 929361, 557480, -211752, -531189, 243974, 512368, 204462, 459490, 48399, -646672, -252747, -321016, -958197, 217347, -681733, 67071, 13250, -98138, 730788, -22814, -263203, 859497, 301360, 852787, -46852, -519019, 631783, 441717, -692162, -309564, -857965, 250887, -3649, 950653, -604443, -302903, 25033, -45991, 291263, -991378, -162043, -463393, -841802, 227328, 94105, -582638, 531113, 207468, 402796, -485486, -464877, 263047, 941678, -246571, 854891, -912024, -615989, 556512, -455247, 835395, 111063, 540647, 459425, -542859, -553001, -379797, 884779, -636745, 85469, 267985, 594550, 663353, -269907, 830668, 381947, 314467, 37737, 152931, -383045, 843523, 571779, -20790, 753370, 931717, -970844, 331984, -812972, 920719, 537310, 806106, 472799, -235344, 351683, 134284, -852212, -671525, -710041, -797192, -205564, -635995, -664090, 620844, -382558, 337848, -500034, 849644, 861117, -883663, -814692, -982265, -654828, -966020, 644948, -963070, -869988, 208565, 955393, 403828, 591694, 493606, 648675, -326004, -731829, -969783, -204669, -525718, -242787, 894452, -200987, 692811, 156239, -485260, 531828, 210478, 500267, 753821, 11843, 742678, 190365, -337200, -102437, -898121, -510208, -302361, -222323, -865926, 521105, -868806, -313062, -570347, 654041, 449587, -281648, -743256, -945967, 973877, -71047, 450747, -354481, -278517, -661413, -315065, 825653, -45008, -470844, -225601, -518140, 576652, -603032, 407429, 555171, -628249], dtype=int)
Y = np.array([-591197, 67518, -292234, -61470, -704923, -369249, -706264, -342094, -30490, -742584, 302408, 328739, -768247, -980250, 854113, 644399, -759762, -713000, -177469, -119692, 486116, -991436, -577904, -199154, 57316, 465593, 876302, -847294, 171186, -458367, -432041, -377388, -721714, 157389, -378567, -76998, 19943, 566478, 139565, 838611, -529684, -667437, -71855, -173290, -246091, -42500, -955548, 728332, -139794, 373990, -712990, -675528, -593853, 185409, -223998, -954604, 640259, 895426, 358891, -813003, -432166, 798101, -544061, 644991, -336892, -55194, 128095, 398109, -98806, -890499, 744657, -863328, -694457, 409930, 542792, -755337, 443531, -922005, 488097, 744003, 289307, -24763, -64924, -826375, -134429, -301818, 919882, 391777, -228622, 819726, -975657, 17180, 669662, 851079, 235716, 69626, 61997, -8372, -795394, -77403, 324899, -372395, -70595, 714765, -323759, -933699, -840667, 903878, 284099, -117736, 132726, -428526, -866301, -414231, 555221, 80953, -10399, -96106, -800340, 143393, -52482, -839358, -560093, 779905, 86483, -485244, -906979, -778705, 466953, 26229, 63632, 64712, -788917, -551375, -125500, -426663, -117376, 846202, -858613, 589118, 742356, -287800, -65407, -38403, 963807, -26800, -590971, -241371, -161293, -586499, 942176, -215299, -239537, 647468, 175506, 675495, -811420, -901832, -643137, -92023, 775781, -49315, -549091, 730289, 983286, 524667, 365439, -756045, -830723, -568683, 752507, -358397, 747168, 184225, 649422, 693878, 408548, -976313, -115673, -622162, -454649, -907045, -508470, -459065, 173513, 318714, -498334, 196222, -458334, -84121, -871127, -893789, -105752, 395883, -870439, -935941, -928454, -846020, 998398, -905310, 739692, 248117, 883525, 778226, 731763, 378043, -178370, 277276, 238864, 264066, 41386, -100043, 663254, 207658, 260016, 966557, -837218, -933066, 86711, 601461, 436018, 543759, -825332, 96926, 583393, 607134, 543406, -349232, -988613, 401745, 52042, 678470, 537750, 505043, 539325, 783401, 723025, 328223, 562365, -884743, -957590, 390340, 824330, -175743, 314350, 906202, -261528, 760138, -441795, 949473, 837352, 841427, 369145, 583179, -613526, -273258, -19477, -496785, -642696, 661106, -818936, 589028, -512829, -508270, -167857, 208002, 464507, 887607, -593673, -519506, -772372, -209770, 805036, -655336, 723970, -887265, -113431, 331090, -156824, 578343, -155391, 641715, 402345, -90627, 852014, -239720, -315850, 211034, -221047, -662252, 673941, 565400, -216902, -589553, 241329, -352301, 345564, 213156, 722799, 584412, 277610, -236535, -971056, -60276, -897093, -821095, 266559, 633201, 46451, 898067, -65434, -112681, -572636, -614967, -882467, 794440, 317681, -876134, -214409, -332443, 308324, 2068, 148797, -370778, -889688, -214376, -422352, -174497, -657433, -254196, -243290, 958147, 773783, 692148, -641983, -860759, -867775, -678416, 921795, 41230, 363706, -9170, 180835, 476730, 718148, 557216, -61518, -854522, -833790, -958987, 546299, -688111, 295537, -754988, -13358, -676525, 762769, -391441, -681951, 246706, 353846, -931484, 885700, -620694, 668063, -806286, 446779, -752768, 524801, -798395, 53695, -631253, -851090, 47347, -796328, 433777, 909713, -971902, 367695, 703541, -665858, -664771, -634020, -815999, 439685, -450408, 707833, 85938, 759117, 100280, -517685, -382714, 289696, -282165, -865724, 61370, -585493, 838792, -608278, 512985, -215681, -118552, 934236, -814800, -795379, 836604, -317214, 666661, -906332, 274909, 520250, -753572, -1217, -880914, 508019, -310107, 685641, 162683, 400182, 82519, 574317, -587744, -648008, -328449, -254828, -555012, 980341, 672692, -84937, -177438, 984880, -169538, -123974, -908408, 668640, -208666, 808280, -567655, 174366, 74023, 688688, 518510, 262169, -555820, -605774, 181334, -196217, -183362, -430109, 672310, 945244, -210631, 522210, 836006, -314311, -807719, -743213, -792372, 170064, 320927, 817539, 606657, 621045, -525792, 862103, 681877, 714922, -893105, 454777, 192550, -308385, 924310, 328599, -223223, 396410, 188802, -356069, -346720, 668046, -950762, -717674, 825892, 184087, -37348, -825155, 81467, 22352, 810476, -981441, 831511, 769534, 603645, 105049, 483006, -564125, -519124, -420018, 369874, -758207, -226177, 471028, 725757, -693426, -140320, 902645, -258758, -77623, 314925, 271796, 430934, 203228, 724753, 160346, -705351, 6687, -785162, 179422, 158063, 475643, 852583, 870508, 986305, -464540, -561370, 309752, 350167, -808941, 624717, 772197, -970681, 206865, -522014, -866086, 422871, -70090, -403861, -891940, -897786, -695900, 677338, 283143, -75217, 859667, -63256, -873994, -267413, 665944, -779836, 87665, 236470, 837833, -627819, 402162, 306512, -693302, 105731, 662481, 349008, -602239, -661796, -438194, 516216, 814708, -895000, -671603, 148070, -58666, 979783, -405104, 825211, -321302, -511906, -186329, -176003, 392990, -849812, 724804, 798069, -815870, 565808, 613004, 832362, 363829, -400540, -164331, 132939, 644988, 558783, -152617, -99230, 442270, 628638, 532949, -961129, 711055, -788687, 948112, 47093, -829496, -467661, 542641, 113916, 501102, -815825, -166689, -243845, -6625, 469209, 380648, 947707, -8637, 684202, -85812, 784169, -386458, 102457, 653354, -527472, -630475, -667127, -256321, 244317, 326011, 472437, 957700, 466485, -821834, 682742, -151829, 486004, 139380, -877258, -383803, -512397, 449639, -671873, -823002, -322842, 879821, -382418, 829543, -408761, -567434, 929582, 157135, 320888, -773750, 359618, -241162, 391299, -45644, 172609, -139299, -751169, 242947, 537425, -89297, -180608, -911744, 6331, -805049, -498080, 223756, -514079, -862833, -928124, 925140, 711537, 901934, 455496, -754173, 326148, -559675, 363591, -860205, 718957, 804830, -905608, -658115, 957265, 466739, -108885, -32202, 159426, -346830, -651931, -754620, -12206, -763200, 336936, -742689, -322893, -135082, 409790, 957896, -718752, 233997, 373054, 90935, 365845, -500575, -588702, -398013, 38818, -236227, -778018, -837424, -393904, 215927, -155210, -546, -834546, 47072, -959119, 874743, -560378, 738010, -43652, 207930, -272733, 777338, 955749, -708673, 705655, 254418, -274825, 37886, -510174, 112105, -779595, -245673, 9557, -788260, 446720, 517485, -46989, -559431, -907443, -792607, -535619, -527464, -315208, 739955, 48352, -587741, 683547, 229856, -446630, 819459, -284171, -311956, -791042, -79804, -328393, -10405, 105216, -998547, 206812, 328760, -321504, -623357, 993814, -40003, -9123, 213890, 344475, 222751, -686744, -514203, 648323, -208974, -538641, -37912, 679209, -325592, -733712, -830174, 757525, -517409, -939701, -42552, -230881, 268105, 7758, -174587, -200925, -603405, -988385, -265213, -325710, 199158, 492476, 451056, -690692, -919322, 601247, 71016, 244950, 791638, 75982, -429208, 426395, 35536, -853924, -625062, 491998, -45165, 11412, -590375, -534677, 920759, -564263, 945686, 914974, 241679, 877123, 796216, -110889, 626970, 286563, -429931, 677680, 365039, 206382, -198601, -537532, -533628, 61243, -593284, 942645, 76603, -122926, -170950, 575522, 620424, -752170, -272204, -40583, -381735, 713172, -63873, 661227, -840964, -610691, 237634, 165538, -91123, -835004, -834160, 998859, -993689, -779714, 929361, 557479, -211753, -531188, 243975, 512367, 204463, 459491, 48400, -646673, -252748, -321016, -958196, 217346, -681732, 67071, 13250, -98137, 730788, -22815, -263203, 859496, 301361, 852788, -46853, -519018, 631783, 441716, -692163, -309565, -857964, 250888, -3648, 950654, -604444, -302903, 25034, -45990, 291264, -991379, -162042, -463394, -841803, 227328, 94105, -582639, 531113, 207469, 402797, -485486, -464876, 263046, 941678, -246570, 854892, -912023, -615990, 556513, -455247, 835395, 111063, 540647, 459424, -542860, -553002, -379798, 884780, -636746, 85468, 267986, 594551, 663353, -269908, 830667, 381947, 314466, 37738, 152931, -383044, 843523, 571779, -20791, 753369, 931718, -970844, 331984, -812973, 920718, 537310, 806107, 472799, -235343, 351682, 134284, -852211, -671526, -710040, -797192, -205565, -635995, -664089, 620845, -382557, 337848, -500035, 849644, 861116, -883662, -814691, -982264, -654827, -966019, 644947, -963070, -869988, 208564, 955393, 403827, 591694, 493607, 648676, -326004, -731828, -969782, -204670, -525718, -242788, 894452, -200988, 692810, 156240, -485261, 531829, 210478, 500266, 753822, 11844, 742678, 190365, -337201, -102438, -898121, -510208, -302360, -222324, -865925, 521105, -868807, -313061, -570348, 654041, 449587, -281648, -743257, -945966, 973876, -71048, 450748, -354481, -278516, -661412, -315065, 825653, -45007, -470843, -225601, -518139, 576651, -603032, 407428, 555172, -628248], dtype=int)

r1, s, sh, r = fe.generate(X, 8)
r2 = fe.reproduce(Y, s, sh, r)

if r2 == 0:
    print("reproduction failed")
else:
    print(np.frombuffer(r1, dtype=int), '\n', np.frombuffer(r2, dtype=int))
